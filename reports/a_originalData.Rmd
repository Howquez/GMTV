---
title: "1. Original Data"
description: |
  Reproducing Gächter et al.'s main findings.
author:
  - name: Hauke Roggenkamp 
    url: https://github.com/Howquez
    affiliation: CLICCS
    affiliation_url: https://www.cliccs.uni-hamburg.de/
date: "`r Sys.Date()`"
bibliography: biblio.bib
output:
  distill::distill_article:
    toc: true
    toc_depth: 2
    toc_float: false
    code_folding: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(haven)
library(data.table)
library(magrittr)
library(kableExtra)
library(DescTools) # gini coefficient
library(downloadthis)
library(Rmisc)
library(ggplot2)
library(wesanderson)
```

# Background 

In an attempt to incorporate uncertainty to @GACHTER2017's dynamic public goods game (DPGG), I plan to run a series of remote online experiments using oTree [@oTree]. The first experiment will replicate Gächter et al.'s NOPUNISH 10-period version as close as possible (given the remote circumstances). The current demo version of the experiment can be found [here](https://cliccs.herokuapp.com/). Click [here](https://github.com/Howquez/coopUncertainty) to visit the corresponding Github repository.

This report is the first in a series of reports covering this project. It prepares the original data and replicates main visualizations & tables.

# Load Data

```{r readData}
DT <- read_dta(file="../data/gaechteretal/GMTV-data.dta") %>% data.table()
DT <- DT[order(treat, gr_id, per)]
```

# Calulate Variables

```{r calcVars}
DT[,
   gini2 := Gini(c(tokens, other1, other2, other3)),
   by = .(subj_id, per)]

DT[,
   mean2 := sum/gdp]
```


# Subset

```{r}
temp <- DT[exp_num == 5 | exp_num == 8 | exp_num == 9]
temp[order(gr_id, per),
         .(exp_num, gr_id, per, subj_id, # IDs
             tokens, other1, other2, other3, gdp, #endowments
             putin, pu1, pu2, pu3, sum, mean, mean2, # contributions
             gini, gini2)] %>% 
  head(n = 9) %>%
  kbl()
```

